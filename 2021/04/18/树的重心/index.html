<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>树的重心 - 黄阿信</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="树的重心 - 黄阿信" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="https://yalexin.gitee.io/2021/04/18/%E6%A0%91%E7%9A%84%E9%87%8D%E5%BF%83/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2021-04-18T08:05:35.000Z" />
  
  <meta property="og:article:author" content="YaleXin" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
</head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/projects">Projects</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/算法/">算法</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>April</span>
            <span>18,</span>
            <span>2021</span>
        </div>
        

        <h1 class="title">树的重心</h1>
    </div>

    <div class="divider"></div>

    <div class="content">
        <blockquote>
<p>本文参考洛谷对于<a href="https://www.luogu.com.cn/problem/solution/P1364" target="_blank" rel="noopener">P1364</a>的题解</p>
</blockquote>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p> 对于树上的每一个点，计算其所有子树中最大的子树节点数，这个值最小的点就是这棵树的重心。 <a id="more"></a></p>
<h2 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h2><ul>
<li>树中所有点到某个点的距离和中，到重心的距离和是最小的，如果有两个重心，他们的距离和一样 </li>
<li>插入或删除一个点，树的重心的位置最多移动一个单位。 </li>
<li>把两棵树通过一条边相连，新的树的重心在原来两棵树重心的连线上。 </li>
</ul>
<p>这些性质我就不证明了，<del>比较懒</del>（不太懂证明）</p>
<h2 id="求法"><a href="#求法" class="headerlink" title="求法"></a>求法</h2><h3 id="无权树"><a href="#无权树" class="headerlink" title="无权树"></a>无权树</h3><p>实际上，一个如果定义<code>size[i]</code>为以<code>i</code>节点的为根的子树的节点个数，可以很轻易地得到</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="23.361ex" height="5.447ex" viewbox="0 -1250 10325.7 2407.8" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style=""><defs><path id="MJX-2-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/><path id="MJX-2-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/><path id="MJX-2-TEX-I-1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z"/><path id="MJX-2-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"/><path id="MJX-2-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"/><path id="MJX-2-TEX-I-1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"/><path id="MJX-2-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"/><path id="MJX-2-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/><path id="MJX-2-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/><path id="MJX-2-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"/><path id="MJX-2-TEX-LO-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"/><path id="MJX-2-TEX-I-1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><use xlink:href="#MJX-2-TEX-I-1D460"/></g><g data-mml-node="mi" transform="translate(469, 0)"><use xlink:href="#MJX-2-TEX-I-1D456"/></g><g data-mml-node="mi" transform="translate(814, 0)"><use xlink:href="#MJX-2-TEX-I-1D467"/></g><g data-mml-node="mi" transform="translate(1279, 0)"><use xlink:href="#MJX-2-TEX-I-1D452"/></g><g data-mml-node="mo" transform="translate(1745, 0)"><use xlink:href="#MJX-2-TEX-N-5B"/></g><g data-mml-node="mi" transform="translate(2023, 0)"><use xlink:href="#MJX-2-TEX-I-1D462"/></g><g data-mml-node="mo" transform="translate(2595, 0)"><use xlink:href="#MJX-2-TEX-N-5D"/></g><g data-mml-node="mo" transform="translate(3150.8, 0)"><use xlink:href="#MJX-2-TEX-N-3D"/></g><g data-mml-node="mn" transform="translate(4206.6, 0)"><use xlink:href="#MJX-2-TEX-N-31"/></g><g data-mml-node="mo" transform="translate(4928.8, 0)"><use xlink:href="#MJX-2-TEX-N-2B"/></g><g data-mml-node="munderover" transform="translate(5929, 0)"><g data-mml-node="mo"><use xlink:href="#MJX-2-TEX-LO-2211"/></g><g data-mml-node="TeXAtom" transform="translate(550.5, -1050) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use xlink:href="#MJX-2-TEX-I-1D463"/></g></g><g data-mml-node="TeXAtom" transform="translate(722, 1150) scale(0.707)" data-mjx-texclass="ORD"/></g><g data-mml-node="mi" transform="translate(7539.7, 0)"><use xlink:href="#MJX-2-TEX-I-1D460"/></g><g data-mml-node="mi" transform="translate(8008.7, 0)"><use xlink:href="#MJX-2-TEX-I-1D456"/></g><g data-mml-node="mi" transform="translate(8353.7, 0)"><use xlink:href="#MJX-2-TEX-I-1D467"/></g><g data-mml-node="mi" transform="translate(8818.7, 0)"><use xlink:href="#MJX-2-TEX-I-1D452"/></g><g data-mml-node="mo" transform="translate(9284.7, 0)"><use xlink:href="#MJX-2-TEX-N-5B"/></g><g data-mml-node="mi" transform="translate(9562.7, 0)"><use xlink:href="#MJX-2-TEX-I-1D463"/></g><g data-mml-node="mo" transform="translate(10047.7, 0)"><use xlink:href="#MJX-2-TEX-N-5D"/></g></g></g></svg></p>
<p>其中<code>v</code>是每一个<code>u</code>的邻接节点。</p>
<p><code>C++</code>实现方式</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @Author      : YaleXin</span></span><br><span class="line"><span class="comment"> * @Email       : me@yalexin.top</span></span><br><span class="line"><span class="comment"> * @LastEditors : YaleXin</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> total;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_N = <span class="number">10000</span>;</span><br><span class="line"><span class="comment">// 邻接表</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; treeTable[MAX_N + <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// treeSize[i]表示以i为根、向下包含的子树的节点个数（包含自身）</span></span><br><span class="line"><span class="keyword">int</span> treeSize[MAX_N + <span class="number">5</span>];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="keyword">int</span> minNode;</span><br><span class="line"><span class="keyword">int</span> minBalance = INF;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> nodeId, <span class="keyword">int</span> parent)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 至少为 1</span></span><br><span class="line">    treeSize[nodeId] = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// maxSubTree代表nodeId的各个子结点中最大的子树数目</span></span><br><span class="line">    <span class="keyword">int</span> maxSubTree = <span class="number">-1</span>, len = treeTable[nodeId].<span class="built_in">size</span>(), son;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        son = treeTable[nodeId][i];</span><br><span class="line">        <span class="keyword">if</span> (son != parent) &#123;</span><br><span class="line">            dfs(son, nodeId);</span><br><span class="line">            treeSize[nodeId] += treeSize[son];</span><br><span class="line">            maxSubTree = <span class="built_in">max</span>(maxSubTree, treeSize[son]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 向下或者向上的子树中，选取一个，即父节点所在的子树也是作为该节点的“子树”</span></span><br><span class="line">    maxSubTree = <span class="built_in">max</span>(maxSubTree, total - treeSize[nodeId]);</span><br><span class="line">    <span class="keyword">if</span> (maxSubTree &lt; minBalance) &#123;</span><br><span class="line">        minBalance = maxSubTree;</span><br><span class="line">        minNode = nodeId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"please input the number of total node\n"</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;total);</span><br><span class="line">    <span class="keyword">int</span> u, v;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"please input every edge as u v\n"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= total - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        treeTable[u].push_back(v);</span><br><span class="line">        treeTable[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    minNode = <span class="number">0</span>;</span><br><span class="line">    minBalance = INF;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"The center of gravity of the tree is %d, Maximum node number of a subtree is %d\n"</span>,</span><br><span class="line">             minNode, minBalance);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="带权树"><a href="#带权树" class="headerlink" title="带权树"></a>带权树</h3><p>以洛谷<a href="https://www.luogu.com.cn/problem/P1364" target="_blank" rel="noopener">P1364</a>为例，其它背景亦类似：</p>
<p>该题可转为找树的重心进行求解。</p>
<p>使用<code>f[u]</code>表示以<code>u</code>为根的总距离 ， <code>size[u]</code>表示以<code>u</code>为根的子树的大小（当然了，本题要设置为相应的权值） ，因此子树的重心就是：</p>
<p><code>w</code>,其中<code>f[w] = min(f[i]),1 &lt;= i &lt;= n</code>.</p>
<p>在算法的开始之前，需要先任意求一个点作为根进行深度优先搜索，求出以该点为根的总距离，这里以<code>1</code>为例。</p>
<p>对于每一个<code>u</code>能达到的点<code>v</code> ，可以使用下面的方程进行求解：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f[v] &#x3D; f[u] + size[1] - size[v] - size[v]</span><br></pre></td></tr></table></figure>

<p>上面的式子的意义是：</p>
<p> 当根从<code>u</code>变为<code>v</code>的时候，<code>v</code>的子树的所有节点原本的距离要到 <code>u</code>，现在只需要到<code>v</code>，即这<code>size[v]</code>个节点距离都减小<code>1</code>，与此同时，除了以<code>v</code>为根的子树节点外的所有的点，原本只要到<code>u</code>即可，现在要到<code>v</code>，即每个节点距离都增加了<code>1</code>，而这些节点共有<code>size[1] - size[v]</code>。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @Author      : YaleXin</span></span><br><span class="line"><span class="comment"> * @Email       : me@yalexin.top</span></span><br><span class="line"><span class="comment"> * @LastEditors : YaleXin</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX_N = <span class="number">101</span>;</span><br><span class="line"><span class="keyword">int</span> treeTable[MAX_N][<span class="number">2</span>], nums[MAX_N], treeSize[MAX_N], f[MAX_N];</span><br><span class="line"><span class="comment">// deepth 是该节点距离 1 号节点的距离</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> nodeId, <span class="keyword">int</span> parent, <span class="keyword">int</span> deepth)</span></span>&#123;</span><br><span class="line">    treeSize[nodeId] = nums[nodeId];</span><br><span class="line">    <span class="keyword">int</span> lChild = treeTable[nodeId][<span class="number">0</span>], rChild = treeTable[nodeId][<span class="number">1</span>];</span><br><span class="line">    <span class="comment">// 如果存在左孩子</span></span><br><span class="line">    <span class="keyword">if</span> (lChild)&#123;</span><br><span class="line">        dfs(lChild, nodeId, deepth + <span class="number">1</span>);</span><br><span class="line">        treeSize[nodeId] += treeSize[lChild];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果存在右孩子</span></span><br><span class="line">    <span class="keyword">if</span> (rChild)&#123;</span><br><span class="line">        dfs(rChild, nodeId, deepth + <span class="number">1</span>);</span><br><span class="line">        treeSize[nodeId] += treeSize[rChild];</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">1</span>] += nums[nodeId] * deepth;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> minAns = <span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> nodeId, <span class="keyword">int</span> parent)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lChild = treeTable[nodeId][<span class="number">0</span>], rChild = treeTable[nodeId][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(lChild)&#123;</span><br><span class="line">        f[lChild] = f[nodeId] + treeSize[<span class="number">1</span>] - (treeSize[lChild] &lt;&lt; <span class="number">1</span>);</span><br><span class="line">        dp(lChild, nodeId);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(rChild)&#123;</span><br><span class="line">        f[rChild] = f[nodeId] + treeSize[<span class="number">1</span>] - (treeSize[rChild] &lt;&lt; <span class="number">1</span>);</span><br><span class="line">        dp(rChild, nodeId);</span><br><span class="line">    &#125;</span><br><span class="line">    minAns = <span class="built_in">min</span>(minAns, f[nodeId]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">int</span> n, w, u, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;nums[i], &amp;treeTable[i][<span class="number">0</span>], &amp;treeTable[i][<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    dp(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; minAns &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by YaleXin, licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0" target="_blank" rel="noopener">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/贪心算法/" class="tag">#贪心算法</a><a href="/tags/动态规划/" class="tag">#动态规划</a><a href="/tags/递归/" class="tag">#递归</a><a href="/tags/C/" class="tag">#C++</a><a href="/tags/深度优先/" class="tag">#深度优先</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2021/04/24/Bellman-Ford%E7%AE%97%E6%B3%95%E6%A8%A1%E6%9D%BF/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">Bellman-Ford算法模板</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2021/04/11/%E6%9C%80%E5%A4%A7%E5%AD%90%E7%9F%A9%E9%98%B5%E5%92%8C/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">最大子矩阵和</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/projects" class="item">Projects</a>
                
                <a href="/resume" class="item">Resume</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a href="https://github.com/MrWillCom/rsa-cli" target="_blank" rel="noopener" class="item">RSA CLI</a>
                
                <a href="https://github.com/MrWillCom/hexo-theme-cupertino" target="_blank" rel="noopener" class="item">Hexo Theme Cupertino</a>
                
                <a href="https://github.com/MrWillCom/a-calendar" target="_blank" rel="noopener" class="item">A Calendar</a>
                
                <a href="https://github.com/MrWillCom/auto-mirroring-bucket" target="_blank" rel="noopener" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a href="https://github.com/MrWillCom" target="_blank" rel="noopener" class="item">GitHub</a>
                
                <a href="https://codepen.io/mrwillcom" target="_blank" rel="noopener" class="item">CodePen</a>
                
                <a href="https://www.patreon.com/MrWillCom" target="_blank" rel="noopener" class="item">Patreon</a>
                
                <a href="https://noc.social/@MrWillCom" target="_blank" rel="noopener" class="item">Mastodon</a>
                
                <a href="https://discord.gg/UKuFDjcfY8" target="_blank" rel="noopener" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 YaleXin<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>