<!DOCTYPE html>
<html lang="zh-CN">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>RSA的常见攻击 - 黄阿信</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="RSA的常见攻击 - 黄阿信" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="https://yalexin.gitee.io/2022/08/15/RSA%E7%9A%84%E5%B8%B8%E8%A7%81%E6%94%BB%E5%87%BB/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2022-08-15T01:56:47.000Z" />
  
  <meta property="og:article:author" content="YaleXin" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
<link rel="stylesheet" href="/css/toc.css">

  
  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
</head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        data-toc="true"
        data-toc-max-depth="2"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Blog</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/archives">Archives</a>
            
            
            
            <a class="nav-item" href="/friends">Friends</a>
            
            
            
            <a class="nav-item" href="/projects">Projects</a>
            
            
            
            <a class="nav-item" href="/about">About</a>
            
            
            
            <a class="nav-item nav-item-github nav-item-icon" href="https://github.com/MrWillCom" target="_blank" aria-label="GitHub">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-codepen nav-item-icon" href="https://codepen.io/mrwillcom" target="_blank" aria-label="CodePen">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-patreon nav-item-icon" href="https://www.patreon.com/MrWillCom" target="_blank" aria-label="Patreon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-mastodon nav-item-icon" href="https://noc.social/@MrWillCom" target="_blank" aria-label="Mastodon">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-discord nav-item-icon" href="https://discord.gg/UKuFDjcfY8" target="_blank" aria-label="Discord">&nbsp;</a>
            
            
            
            <a class="nav-item nav-item-search nav-item-icon" href="/search" target="_blank" aria-label="Search">&nbsp;</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        
        <div class="categories text-uppercase">
        
            <a href="/categories/算法/">算法</a>
        
        </div>
        

        
        <div class="date" id="date">
            <span>August</span>
            <span>15,</span>
            <span>2022</span>
        </div>
        

        <h1 class="title">RSA的常见攻击</h1>
    </div>

    <div class="divider"></div>

    <div class="content">
        <p>本文参考自文章<a href="https://weread.qq.com/web/bookDetail/77d32500721a485577d8eee" target="_blank" rel="noopener">【从0到1：CTFer成长之路-第7章】</a></p>
<p>上文我们介绍了RSA算法原理，只要我们设置得当，我们有足够多的理由相信我们的RSA系统是安全的，但是粗心的我们，能否禁得住黑客的攻城掠池？下面介绍一些RSA的常见攻击。<a id="more"></a></p>
<h2 id="1-因式分解"><a href="#1-因式分解" class="headerlink" title="1.因式分解"></a>1.因式分解</h2><p>产生公钥和私钥的时候，我们用到了p，q，e，我们对外公布的是p和q的乘积以及e。如果我们选用的p和q太小，很容易就被很多工具将二者的乘积进行因式分解，从而获得了p和q。</p>
<p>有很多在线工具可以将大数进行因式分解，也有一些开源工具，这里以<a href="https://sourceforge.net/projects/yafu/" target="_blank" rel="noopener">Yafu</a>为例,对于阿珍的公钥&lt;n,e&gt;=&lt;16422644908304291,65537&gt;</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">D:\HackTools\yafu-1.34&gt;yafu-x64.exe</span><br><span class="line">factor(16422644908304291)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fac: factoring 16422644908304291</span><br><span class="line">fac: using pretesting plan: normal</span><br><span class="line">fac: no tune info: using qs/gnfs crossover of 95 digits</span><br><span class="line">div: primes less than 10000</span><br><span class="line">fmt: 1000000 iterations</span><br><span class="line">Total factoring time = 0.0058 seconds</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">***factors found***</span><br><span class="line"></span><br><span class="line">P9 = 134235139</span><br><span class="line">P9 = 122342369</span><br><span class="line"></span><br><span class="line">ans = 1</span><br></pre></td></tr></table></figure>

<p>继续使用<code>python</code>的<code>Gmpy2</code>库可以很容易求逆元：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p, q, e = <span class="number">134235139</span>, <span class="number">122342369</span>, <span class="number">65537</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 求 e mod phi 的逆元</span></span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># 8237257961022977</span></span><br></pre></td></tr></table></figure>

<p>此外，如果<code>p</code>和<code>q</code>的差距较小，根据下面的式子：<br>$$<br>(\frac{p+q}{2} )^2-pq=(\frac{p-q}{2} )^2<br>$$<br>直接暴力枚举<code>p</code>和<code>q</code>的差值，寻找<code>p</code>和<code>q</code></p>
<h2 id="2-低加密指数小明文攻击"><a href="#2-低加密指数小明文攻击" class="headerlink" title="2.低加密指数小明文攻击"></a>2.低加密指数小明文攻击</h2><p>如果阿强想要发送的数据很短，很简单，即明文<code>m</code>编码后，对应数学上，其数值很小，加上其公钥中的<code>e</code>很小，计算<code>m^e</code>的值并没有超过<code>n</code>，那么我们想要得到明文，直接将密文开<code>e</code>次方即可。</p>
<p>此外，如果密文<code>c</code>虽然大于<code>n</code>，但是并不是太大，由于：<br>$$<br>c\equiv m^e \pmod{n}<br>$$<br>即存在整数k，使得：<br>$$<br>c+kn=m^e<br>$$<br>我们可以直接暴力枚举<code>k</code>，然后将其开<code>e</code>次方，如果可以开得尽，则说明找到了明文<code>m</code>。</p>
<h2 id="3-共模攻击"><a href="#3-共模攻击" class="headerlink" title="3.共模攻击"></a>3.共模攻击</h2><p>如果阿珍使用了相同的<code>n</code>，不同的指数<code>e1</code>，<code>e2</code>,同时这两个指数互素，并且得到了对同一组明文加密后的密文<code>c1</code>和<code>c2</code>，在不获取私钥的情况下也能将明文解来，原理如下：</p>
<p>设：<br>$$<br>c_1=m^{e_1}\pmod{n}<br>$$<br>和<br>$$<br>c_2=m^{e_2}\pmod{n}<br>$$<br>由于<code>e1</code>和<code>e2</code>互素，存在整数x和y，使得：<br>$$<br>xe_1+ye_2=1<br>$$<br>x和y可以通过<a href="https://baike.baidu.com/item/%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/2029414" target="_blank" rel="noopener">扩展欧几里得算法</a>求解出来。</p>
<p>进一步有：<br>$$<br>c_{1}^{x}c_{2}^{y} \pmod{n}=m^{xe_1}m^{ye_2}\pmod{n}=m^1\pmod{n}=m<br>$$<br>即可获得明文。</p>
<h2 id="4-广播攻击"><a href="#4-广播攻击" class="headerlink" title="4.广播攻击"></a>4.广播攻击</h2><p>对于相同的明文，如果阿强使用了相同的明文<code>m</code>，相同的指数<code>e</code>，但是不同的<code>n1</code>,<code>n2</code>,<code>n3</code>…<code>nh</code>(h&gt;=e)，同时暴露了对应的每个密文，可以使用中国剩余定理解出明文<code>m</code>。</p>
<p>设：<br>$$<br>\left{\begin{matrix}<br>c_1=m^e\pmod{n_1}<br> \<br>c_2=m^e\pmod{n_2}<br>\<br>…<br>\<br>c_h=m^e\pmod{n_h}<br>\end{matrix}\right.<br>$$<br>借助<a href="https://baike.sogou.com/v1853008.htm?fromTitle=%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86" target="_blank" rel="noopener">中国剩余定理</a>,假设<code>ni</code>两两互素，令：<br>$$<br>N=\prod_{i=1}^{h} n_i<br>$$</p>
<p>$$<br>N_i=\frac{N}{n_i}<br>$$</p>
<p>则上述同余方程组有唯一解：<br>$$<br>X=m^e\equiv\sum_{i=1}^{h} c_iN_iy_i \pmod{N}<br>$$<br>其中：<br>$$<br>N_iy_i\equiv1\pmod{n_i}<br>$$</p>
<p>例如，假设张三想要发送消息给甲乙丙三个人，张三手上也有对应的三个公钥<code>&lt;205,3&gt;&lt;187,3&gt;&lt;667,3&gt;</code>，他想发送的消息<code>m=10</code>，加密后的密文分别是180，65，333</p>
<p>这三组公钥和密文在传输过程中被李四截取，他立马写下脚本进行窃取：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 中国剩余定理的代码来自rosettacode Wiki</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(c,n)</span>:</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    <span class="comment"># ni 的乘积,N=n1*n2*n3</span></span><br><span class="line">    N = reduce(<span class="keyword">lambda</span> x,y:x*y,n)</span><br><span class="line">    <span class="comment"># zip()将对象打包成元组</span></span><br><span class="line">    <span class="keyword">for</span> n_i, c_i <span class="keyword">in</span> zip(n,c):</span><br><span class="line">        <span class="comment"># Ni=N/ni</span></span><br><span class="line">        N_i = N // n_i</span><br><span class="line">        <span class="comment"># Ni y == 1 % ni 求逆元</span></span><br><span class="line">        y = gmpy2.invert(N_i,n_i)</span><br><span class="line">        sum += c_i * N_i * y</span><br><span class="line">    <span class="keyword">return</span> sum % N</span><br><span class="line">n1, n2, n3 = <span class="number">205</span>, <span class="number">187</span>, <span class="number">667</span></span><br><span class="line">c1, c2, c3 = <span class="number">180</span>, <span class="number">65</span>, <span class="number">333</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n = [n1, n2, n3]</span><br><span class="line">c = [c1, c2, c3]</span><br><span class="line"></span><br><span class="line">x = CRT(c,n)</span><br><span class="line"><span class="comment"># 将x开e次方</span></span><br><span class="line">m = gmpy2.iroot(x,e)[<span class="number">0</span>]</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>



<h2 id="5-低解密指数攻击"><a href="#5-低解密指数攻击" class="headerlink" title="5.低解密指数攻击"></a>5.低解密指数攻击</h2><p>1989年，Michael J.Wiener发表了<a href="https://ieeexplore.ieee.org/abstract/document/54902" target="_blank" rel="noopener">Cryptanalysis of Short RSA Secret Exponents</a>文章，提出了一种针对解密指数<code>d</code>较低时对于RSA的攻击方法，该方法基于连分数,设：<br>$$<br>ed=1+k \varphi(n)<br>$$<br>当q&lt;p&lt;2q时，若满足：<br>$$<br>d&lt;\frac{1}{3}  n ^{\frac{1}{4}}<br>$$<br>则通过搜索连分数e/N的收敛，可以有效率地找到k/d，从而恢复正确的d。</p>
<p>目前，对于此种攻击已有完备的实现，在<a href="https://github.com/pablocelayes/rsa-wiener-attack" target="_blank" rel="noopener">GitHub</a>可以找到完整可用的攻击代码</p>
<h2 id="6-dp泄露"><a href="#6-dp泄露" class="headerlink" title="6.dp泄露"></a>6.dp泄露</h2><blockquote>
<p>dp = d % (p-1)并非字面上d和p相乘</p>
</blockquote>
<p>如果已知<code>dp</code>,<code>e</code>,<code>n</code>,<code>c</code>，则可以解出明文<code>m</code>。证明如下,已知：<br>$$<br>c \equiv m^e \pmod{n} \tag{1}<br>$$</p>
<p>$$<br>m \equiv c^d \pmod{n} \tag{2}<br>$$</p>
<p>$$<br>DP = d \bmod(p-1) \tag{3}<br>$$</p>
<p>对式子（3）两边同乘<code>e</code>，有<br>$$<br>DP e\equiv de \pmod{p-1}<br>$$<br>则存在整数<code>k1</code>，使得：<br>$$<br>de=k_1(p-1)+DPe \tag{4}<br>$$<br>而<br>$$<br>de\equiv1 \pmod{\varphi(n)}<br>$$<br>即<br>$$<br>de\equiv1\pmod{(p-1)(q-1)}<br>$$<br>故存在一个整数<code>k2</code>，使得：<br>$$<br>de=k_2(p-1)(q-1)+1<br>$$<br>带入到式子（4）并整理，得到<br>$$<br>DPe=(p-1)(k_2(q-1)-k_1) + 1<br>$$<br>再令<br>$$<br>x=k_2(q-1)<br>$$<br>即<br>$$<br>DPe=(p-1)x+1<br>$$<br>解得<br>$$<br>x=\frac{DPe}{p-1}-\frac{1}{p-1}<br>$$<br>根据定义，<code>DP&lt;(p-1)</code>，因此<code>1&lt;x&lt;e</code>。</p>
<p>如果<code>e</code>不大，我们可以直接暴力枚举<code>x</code>,当其能够整除<code>DPe-1</code>时候，则<code>p</code>就可以找到了，找到以后进一步解得<code>q</code>，进一步得到<code>d</code>，从而恢复原文。</p>
<p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line"><span class="comment"># 在范围(1,e)之间进行遍历</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, e):</span><br><span class="line">    <span class="comment"># 若存在 x ，使得 de*e - 1 能被 x 整除</span></span><br><span class="line">    <span class="keyword">if</span> (dp * e - <span class="number">1</span>) % x == <span class="number">0</span>:</span><br><span class="line">        pp = ((dp * e - <span class="number">1</span>) // x) + <span class="number">1</span></span><br><span class="line">        <span class="comment"># 确保 p 能够整除 n</span></span><br><span class="line">        <span class="keyword">if</span> n % pp == <span class="number">0</span>:</span><br><span class="line">            p = pp</span><br><span class="line">            q = n // (((dp * e - <span class="number">1</span>) // x) + <span class="number">1</span>)</span><br><span class="line">            phi = (q - <span class="number">1</span>) * (p - <span class="number">1</span>)</span><br><span class="line">            <span class="comment"># 求模逆</span></span><br><span class="line">            d = gmpy2.invert(e, phi)</span><br><span class="line">            m = gmpy2.powmod(c, d, n)</span><br><span class="line">            print(m)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="7-dp-dq泄露"><a href="#7-dp-dq泄露" class="headerlink" title="7. dp,dq泄露"></a>7. dp,dq泄露</h2><blockquote>
<p>dp = d % (p-1), dq = d % (q-1),并非字面上d和p相乘</p>
</blockquote>
<p>如果已知<code>dp</code>,<code>dq</code>,<code>p</code>,<code>q</code>,<code>c</code>，则可以解出明文<code>m</code>。证明如下,已知<br>$$<br>c \equiv m^e \pmod{n} \tag{1}<br>$$</p>
<p>$$<br>m \equiv c^d \pmod{n} \tag{2}<br>$$</p>
<p>$$<br>DP = d \bmod(p-1) \tag{3}<br>$$</p>
<p>$$<br>DQ = d \bmod(q-1) \tag{4}<br>$$</p>
<p>由式子（2）可得：<br>$$<br>m=c^d+kn=c^d+kpq<br>$$<br>对上式子分别对<code>p</code>和<code>q</code>取模,有：<br>$$<br>m_1 \equiv c^d \pmod{p} \tag{5}<br>$$</p>
<p>$$<br>m_2 \equiv c^d \pmod{q} \tag{6}<br>$$</p>
<p>对式子（5），话句话说，有：<br>$$<br>m_1 + kp = c^d \tag{7}<br>$$<br>即：<br>$$<br>m_1+kp \equiv c^d \pmod{q}<br>$$<br>将上式子带入式子（6），有：<br>$$<br>kp \equiv (m_2-m_1) \pmod{q}<br>$$<br>因为<code>p</code>和<code>q</code>互素，二者最大公约数为1,有：<br>$$<br>k \equiv p’(m_2-m_1) \pmod{q} \tag{8}<br>$$<br><code>p&#39;</code>是<code>p</code>关于<code>q</code>的逆元,即：<br>$$<br>pp’ \equiv1 \pmod{q}<br>$$<br>联立（7）和（8），有：<br>$$<br>c^d=m_1+((p’(m_2-m_1) )\bmod{q} )p<br>$$<br>再带入式子（2），有：<br>$$<br>m \equiv (m_1+((p’(m_2-m_1) )\bmod{q} )p )\pmod{n} \tag{9}<br>$$<br>下面我们来求<code>m1</code>和<code>m2</code>.</p>
<p>由式子（3），得：<br>$$<br>d=DP+k(p-1)<br>$$<br>将上式子（5），有：<br>$$<br>m_1 \equiv c^{DP+k(p-1)} \pmod{p}<br>$$<br>即：<br>$$<br>m_1 \equiv c^{DP}c^{k(p-1)} \pmod{p}<br>$$<br>根据费马小定理，若<code>p</code>是素数,且<code>gcd(c,p)=1</code>，则<code>c^(p-1)=1 mod p</code>。</p>
<p>即<br>$$<br>c^{k(p-1)} \pmod{p} \equiv (c^{p-1}\pmod{p})^{k}\pmod{p}\equiv1<br>$$<br>故：<br>$$<br>m_1=c^{DP} \pmod{p}<br>$$<br>同理<br>$$<br>m_2=c^{DQ} \pmod{q}<br>$$<br>将这两个式子回代到式子（9）即可求出明文。</p>
<p>使用<code>python</code>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line">n = p * q</span><br><span class="line">m1 = pow(c,dp,p)</span><br><span class="line">m2 = pow(c,dq,q)</span><br><span class="line">I = gmpy2.invert(p,q)</span><br><span class="line">m = (m1 + I * ((m2 - m1) % q) * p) % n</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p>8</p>

    </div>

    
    <div class="about">
        <h1>About this Post</h1>
        <div class="details">
            <p>This post is written by YaleXin, licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0" target="_blank" rel="noopener">CC BY-NC 4.0</a>.</p>
        </div>
        
        <p class="tags">
            
            <i class="icon"></i>
            <a href="/tags/密码学/" class="tag">#密码学</a>
        </p>
        
    </div>
    

    <div class="container post-prev-next">
        
        <a href="/2022/08/29/BUUCTF-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B42019-%E5%86%B3%E8%B5%9B-PWN5%E9%A2%98%E8%A7%A3/" class="next">
            <div>
                <div class="text">
                    <p class="label">Next</p>
                    <h3 class="title">BUUCTF-[第五空间2019 决赛]PWN5题解</h3>
                </div>
            </div>
        </a>
        
        
        <a href="/2022/08/14/%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E4%B9%8BRSA/" class="prev">
            <div>
                <div class="text">
                    <p class="label">Previous</p>
                    <h3 class="title">公钥密码算法之RSA</>
                </div>
            </div>
        </a>
        
    </div>

    
        
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Blog</h2>
                
                <a href="/" class="item">Blog</a>
                
                <a href="/archives" class="item">Archives</a>
                
                <a href="/tags" class="item">Tags</a>
                
                <a href="/categories" class="item">Categories</a>
                
                <a href="/search" class="item">Search</a>
                
                <a href="/friends" class="item">Friends</a>
                
                <a href="/projects" class="item">Projects</a>
                
                <a href="/resume" class="item">Resume</a>
                
                <a href="/about" class="item">About</a>
                
                <a href="/atom.xml" class="item">RSS</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Projects</h2>
                
                <a href="https://github.com/MrWillCom/rsa-cli" target="_blank" rel="noopener" class="item">RSA CLI</a>
                
                <a href="https://github.com/MrWillCom/hexo-theme-cupertino" target="_blank" rel="noopener" class="item">Hexo Theme Cupertino</a>
                
                <a href="https://github.com/MrWillCom/a-calendar" target="_blank" rel="noopener" class="item">A Calendar</a>
                
                <a href="https://github.com/MrWillCom/auto-mirroring-bucket" target="_blank" rel="noopener" class="item">Auto Mirroring Bucket</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Me</h2>
                
                <a href="https://github.com/MrWillCom" target="_blank" rel="noopener" class="item">GitHub</a>
                
                <a href="https://codepen.io/mrwillcom" target="_blank" rel="noopener" class="item">CodePen</a>
                
                <a href="https://www.patreon.com/MrWillCom" target="_blank" rel="noopener" class="item">Patreon</a>
                
                <a href="https://noc.social/@MrWillCom" target="_blank" rel="noopener" class="item">Mastodon</a>
                
                <a href="https://discord.gg/UKuFDjcfY8" target="_blank" rel="noopener" class="item">Discord</a>
                
                <a href="mailto:mr.will.com@outlook.com" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 YaleXin<br>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>